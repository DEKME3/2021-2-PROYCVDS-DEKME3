<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="edu.eci.cvds.dao.mybatis.mappers.UserMapper">

    <select parameterType="map" id="getUser" resultMap="UserResult">
        SELECT 
        u.id,
        u.name,
        u.password,
        u.email,
        u.status,
        u.userType,  
        FROM Users as u
        WHERE u.name = #{name}
    </select>

    <insert parameterType="map" id="InsertUser" >
        INSERT INTO users (name, password, email, status, usertype, numero_necesidades)
        VALUES(
          #{user.name},
          #{user.password},
          #{user.email},
          #{user.status},
          #{user.userType.id}
          #{user.numero_necesidades}) ;
    </insert>

    <select id="getNumero_necesidades" parameterType="map" resultType="int">
        SELECT numero_necesidades
        FROM users u
        WHERE u.id = #{userId}
    </select>

    <select id="getUserIdByName" parameterType="map" resultType="int">
        SELECT
        u.id
        FROM users u
        WHERE name=#{name}
    </select>

    <select id="getUserType" parameterType="map" resultType="int">
        SELECT
        u.usertype
        FROM users u
        WHERE id=#{userId}
    </select>

    <select id="getTypeIdUser" parameterType="map" resultMap="UserResult">
        SELECT 
        u.id,
        u.name,
        u.password,
        u.email,
        u.status,
        u.userType,  
        FROM Users u
        WHERE u.id = #{idUser};
    </select>

    <resultMap type='User' id='UserResult'>
        <id property='id' column='id'/>
        <result property='name' column='name'/>
        <result property='password' column='password'/>
        <result property='email' column='email'/>
        <result property='status' column='status'/>
        <result property='numero_necesidades' column='numero_necesidades'/>
        <association property='UserType' javaType = 'userType'></association>
    </resultMap>
          	
</mapper>